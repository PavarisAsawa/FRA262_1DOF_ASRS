/*
 * ModeHandler.c
 *
 *  Created on: Apr 27, 2024
 *      Author: emper
 */

#include "ModeHandler.h"
#include "Joystick.h"
#include "main.h"

float MAX_SPEED = 200;
extern TIM_HandleTypeDef htim4;

void Jog_mode(JoystickStructureTypeDef *joystick)
{
	Joystick_UpdateValue(joystick);
		if(joystick->Y < 2146 && joystick->Y >1950)
		{
			__HAL_TIM_SET_COMPARE(&htim4,TIM_CHANNEL_2,0);
		}
		else if(joystick->Y > 2146)
		{
			HAL_GPIO_WritePin(GPIOC, GPIO_PIN_4, SET);
			__HAL_TIM_SET_COMPARE(&htim4,TIM_CHANNEL_2, (uint16_t)(((2146 -joystick->Y)*MAX_SPEED)/2146));
		}
		else if(joystick->Y < 1950)
		{
			HAL_GPIO_WritePin(GPIOC, GPIO_PIN_4, RESET);
			__HAL_TIM_SET_COMPARE(&htim4,TIM_CHANNEL_2,(uint16_t)(((1950-joystick->Y)*MAX_SPEED)/1950) );
		}

}
